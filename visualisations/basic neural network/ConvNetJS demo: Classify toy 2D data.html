<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script src="ConvNetJS%20demo:%20Classify%20toy%202D%20data_files/analytics.js" async=""></script><script src="ConvNetJS%20demo:%20Classify%20toy%202D%20data_files/jquery-1.js"></script>



<title>ConvNetJS demo: Classify toy 2D data</title>
<link href="ConvNetJS%20demo:%20Classify%20toy%202D%20data_files/css.css" rel="stylesheet" type="text/css">

<!-- google analytics stuff -->
<!--script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3698471-21', 'stanford.edu');
      ga('send', 'pageview');

    </script-->


<style>
body {
  font-family: 'Cabin', sans-serif;
  color: #333;
  padding: 20px;
}
</style>

<script src="ConvNetJS%20demo:%20Classify%20toy%202D%20data_files/convnet.js"></script>


<style type="text/css">
#wrap {
  width: 800px;
  margin-right: auto;
  margin-left: auto;
  margin-bottom: 200px;
}
</style>

</head>

<div id="wrap">
<h1>ConvnetJS demo: toy 2d classification with 2-layer neural network</h1>

<p>The simulation below shows a toy binary problem with a few data 
points of class 0 (red) and 1 (green). The 2layer network is set up as:</p>

<pre>var layer_defs = [];
layer_defs.push({type:'input', out_sx:1, out_sy:1, out_depth:2});
layer_defs.push({type:'fc', num_neurons:20, activation: 'relu'});
layer_defs.push({type:'fc', num_neurons:20, activation: 'relu'});
layer_defs.push({type:'softmax', num_classes:2});

var net = new convnetjs.Net();
net.makeLayers(layer_defs);

var trainer = new convnetjs.SGDTrainer(net, {learning_rate:0.01, momentum:0.0, batch_size:1, l2_decay:0.001});
</pre>
<p>Every 10th of a second, all points are fed to the network multiple 
times through the trainer class to train the network. Here's an example 
for one point:</p>
<pre>var x = new convnetjs.Vol(1,1,2);
x.w = [1.8636, 1.1677];
var stats = trainer.train(x, 1);
</pre>

<!-- visualisation divs -->
<div id="basicnet"></div>
<div id="boundaryGraph"></div>



<p>Add red data points by clicking and green data points by shift 
clicking. Watch the classification prediction "landscape" morph as the 
network learns the data points.</p>

<p>Go <a href="http://cs.stanford.edu/people/karpathy/convnetjs/">back to ConvNetJS</a></p>

<script type="text/javascript">


var N= 10; //number of data points
var data = new Array(N);
var points = [];
var labels= new Array(N);

// create neural net
var layer_defs = [];
layer_defs.push({type:'input', out_sx:1, out_sy:1, out_depth:2});
layer_defs.push({type:'fc', num_neurons:20, activation:'relu'});
layer_defs.push({type:'fc', num_neurons:20, activation:'relu'});
layer_defs.push({type:'softmax', num_classes:2});

var net = new convnetjs.Net();
net.makeLayers(layer_defs);

var trainer = new convnetjs.SGDTrainer(net, {learning_rate:0.01, momentum:0.0, batch_size:1, l2_decay:0.001});

//initial data points
  data[0]=[-0.4326  ,  1.1909 ];
  data[1]= [3.0, 4.0];
  data[2]=[0.1253 , -0.0376   ];
  data[3]=[0.2877 ,   0.3273  ];
  data[4]=[-1.1465 ,   0.1746 ];
  data[5]=[1.8133 ,   2.1139  ];
  data[6]=[2.7258 ,   3.0668  ];
  data[7]=[1.4117 ,   2.0593  ];
  data[8]=[4.1832 ,   1.9044  ];
  data[9]=[1.8636 ,   1.1677  ];
  labels[0]= 1;
  labels[1]= 1;
  labels[2]= 1;
  labels[3]= 1;
  labels[4]= 1;
  labels[5]= 0;
  labels[6]= 0;
  labels[7]= 0;
  labels[8]= 0;
  labels[9]= 0;
  
  //testdata d3 code
  for(var i = 0; i < data.length; i++){
      points.push({"x":data[i][0], "y":data[i][1], "label":labels[i]});
  }


//start visualisations: this is implementation helper func for boundary finder
function addPoint(point){
    // add datapoint to the local implementation at location of click
    data.push([point.x, point.y]);
    labels.push(point.label);
    N += 1;
}
</script>

<script src="http://d3js.org/d3.v3.min.js"></script>
<link href="./d3_classify.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./d3_classify.js"></script>
<script type="text/javascript" src="./d3_basicnet.js"></script>
<!-- end visualisation -->
 

<script>
function update(){
  // forward prop the data

  var start = new Date().getTime();

  var x = new convnetjs.Vol(1,1,2);
  //x.w = data[ix];
  var avloss = 0.0;
  for(var iters=0;iters<20;iters++) {
    for(var ix=0;ix<N;ix++) {
      x.w = data[ix];
      var stats = trainer.train(x, labels[ix]);
      avloss += stats.loss;
    }
  }
  avloss /= N*iters;

  var end = new Date().getTime();
  var time = end - start;
      
  //console.log('loss = ' + avloss + ', 100 cycles through data in ' + time + 'ms');
  updateBoundaries(points);
  updateBNet();
}

setInterval(update, 3000);

$(function() {
    
});
</script>

</div>




</body></html>
